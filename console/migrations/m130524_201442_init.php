<?php

use yii\db\Migration;

class m130524_201442_init extends Migration
{
    public function up()
    {
        $tableOptions = null;
        if ($this->db->driverName === 'mysql') {
            // http://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci
            $tableOptions = 'CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ENGINE=InnoDB';
        }

        $this->createTable('{{%menu}}', [
            'id' => $this->primaryKey(),
            'name' => $this->string(128)->notNull(),
            'parent' => $this->integer(),
            'route' => $this->string(),
            'order' => $this->integer(),
            'icon' => $this->string(128),
        ], $tableOptions);
        $this->batchinsert('{{%menu}}',
            ['id','name','parent','route','order','icon'],[
                ['1', '权限管理', null, null, '3', 'fa fa-bullhorn'],
                ['2', '角色列表', '1', '/rbac/role/index', '34', '&#xe6bf;'],
                ['3', '路由列表', '1', '/rbac/route/index', '46', '&#xea3a;'],
                ['4', '权限列表', '1', '/rbac/permission/index', '33', '&#xe60b;'],
                ['5', '分配权限', '1', '/rbac/assignment/index', '37', '&#xe609;'],
                ['6', '菜单列表', '1', '/rbac/menu/index', '36', '&#xe65e;'],
                ['7', '规则列表', '1', '/rbac/rule/index', '35', '&#xe748;'],
                ['8', '后台用户', '1', '/rbac/user/index', '32', '&#xe60d;'],
                ['10', '前台用户', '14', '/system/user/index', '21', '&#xe60d;'],
                ['14', '系统管理', null, null, '2', '&#xe602;'],
                ['15', '配置设置', '14', '/system/config/index', '23', '&#xe609;'],
                ['16', '用户等级', '14', '/system/user-rank/index', '22', '&#xe629;'],
                ['21', '数据备份', '14', '/backup/export/index', '24', '&#xe778;'],
                ['22', '数据恢复', '14', '/backup/import/index', '25', '&#xe777;'],
                ['26', '日志记录', '1', '/rbac/log/index', '31', '&#xe7b8;'],
                ['31', '自动生成', '14', '/gii/default/index', '18', '&#xe614;'],
            ]);

        $this->createTable('{{%admin}}', [
            'id' => $this->primaryKey(),
            'username' => $this->string(32)->notNull(),
            'nickname' => $this->string(32)->notNull()->comment('用户昵称'),
            'head_pic' => $this->string(255)->notNull()->comment('用户头像'),
            'auth_key' => $this->string(32)->notNull(),
            'password_hash' => $this->string()->notNull(),
            'password_reset_token' => $this->string(),
            'email' => $this->string()->notNull(),
            'status' => $this->smallInteger()->notNull()->defaultValue(10),
            'created_at' => $this->integer()->notNull(),
            'updated_at' => $this->integer()->notNull(),
        ], $tableOptions);
        $this->createIndex('admin_id', '{{%admin}}', 'id', false);
        $this->createIndex('admin_username', '{{%admin}}', 'username', false);
        $this->createIndex('admin_email', '{{%admin}}', 'email', false);
        $this->createIndex('admin_status', '{{%admin}}', 'status', false);
        $this->batchinsert('{{%admin}}',
            ['id','username','nickname','head_pic','auth_key','password_hash','password_reset_token','email','status','created_at','updated_at'],[
                ['1', 'admin', '管理员', 'https://www.deaboway.com/wp-content/uploads/2016/12/WechatIMG59.jpg', 'FoFuK-WrcOayDI0_kLdRwGavKN-6mXs6', '$2y$13$bK1PVK/hcl2YZzuRsp7gT.1aY74UZKg6iA4JfxwFKkbJeZ3pr3CaG', null, 'deaboway@gmail.com', '10', '1498634445', '1539942177'],
                ['2', 'demo', '演示账号', 'https://www.deaboway.com/wp-content/uploads/2017/07/The_Wolf_of_Wall_Street.jpg', 'MGILqfoQyFko0kLvlaOxvNRp8LgZA0Qt', '$2y$13$E27DkITDZIJbC0Snm3u8e.G1uueBTI4ubsPtV5S5PjmNroxqLbHJy', null, 'demo@gmail.com', '10', '1521768073', '1521796799'],
            ]);

        $this->createTable('{{%admin_log}}', [
            'id' => $this->primaryKey(),
            'route' => $this->string(255)->notNull(),
            'url' => $this->string(255)->notNull(),
            'user_agent' => $this->string(255)->notNull(),
            'gets' => $this->text(),
            'posts' => $this->text()->notNull(),
            'admin_id' => $this->integer()->notNull(),
            'admin_email' => $this->string()->notNull(),
            'ip' => $this->string()->notNull(),
            'created_at' => $this->integer()->notNull(),
            'updated_at' => $this->integer()->notNull(),
        ], $tableOptions);

        $this->createTable('{{%auth_assignment}}', [
            'item_name' => $this->string(64)->notNull(),
            'user_id' => $this->string(64)->notNull(),
            'created_at' => $this->integer(),
        ], $tableOptions);
        $this->createIndex('auth_assignment_item_name', '{{%auth_assignment}}', 'item_name', false);
        $this->createIndex('auth_assignment_user_id', '{{%auth_assignment}}', 'user_id', false);
        $this->batchinsert('{{%auth_assignment}}',
            ['item_name','user_id','created_at'],[
                ['基本权限', '1', '1539312113'],
                ['文章管理权限', '1', '1539312113'],
                ['演示角色', '1', '1539312113'],
                ['演示角色', '2', '1521768786'],
                ['管理员', '1', '1516773830'],
            ]);

        $this->createTable('{{%auth_item}}', [
            'name' => $this->string(64)->notNull(),
            'type' => $this->smallInteger()->notNull(),
            'description' => $this->text(),
            'rule_name' => $this->string(64),
            'data' => $this->binary(),
            'created_at' => $this->integer(),
            'updated_at' => $this->integer(),
        ], $tableOptions);
        $this->createIndex('auth_item_name', '{{%auth_item}}', 'name', false);
        $this->createIndex('auth_item_type', '{{%auth_item}}', 'type', false);
        $this->createIndex('auth_item_rule_name', '{{%auth_item}}', 'rule_name', false);
        $this->batchinsert('{{%auth_item}}',
            ['name','type','description','rule_name','data','created_at','updated_at'],[
                ['/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/init', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/optimize', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/repair', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/export/start', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/import/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/import/del', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/import/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/import/init', '2', null, null, null, '1513838979', '1513838979'],
                ['/backup/import/start', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/db-explain', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/download-mail', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/toolbar', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/default/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/user/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/user/reset-identity', '2', null, null, null, '1513838979', '1513838979'],
                ['/debug/user/set-identity', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/action', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/diff', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/preview', '2', null, null, null, '1513838979', '1513838979'],
                ['/gii/default/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/assignment/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/assignment/assign', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/assignment/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/assignment/revoke', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/assignment/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/default/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/default/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/log/*', '2', null, null, null, '1521793951', '1521793951'],
                ['/rbac/log/index', '2', null, null, null, '1521793951', '1521793951'],
                ['/rbac/log/view', '2', null, null, null, '1521793951', '1521793951'],
                ['/rbac/menu/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/delete-all', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/menu/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/assign', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/remove', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/permission/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/assign', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/remove', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/role/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/assign', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/refresh', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/route/remove', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/rule/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/active', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/change-password', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/inactive', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/login', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/logout', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/request-password-reset', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/reset-password', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/signup', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/update-self', '2', null, null, null, '1513838979', '1513838979'],
                ['/rbac/user/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/site/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/site/dashboard', '2', null, null, null, '1516773692', '1516773692'],
                ['/site/error', '2', null, null, null, '1513838979', '1513838979'],
                ['/site/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/site/test', '2', null, null, null, '1539312029', '1539312029'],
                ['/system/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/delete-all', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/config/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/memorandum/*', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/create', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/delete', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/delete-all', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/index', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/update', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/memorandum/view', '2', null, null, null, '1528875249', '1528875249'],
                ['/system/neteasy/*', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/create', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/delete', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/delete-all', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/index', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/update', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/neteasy/view', '2', null, null, null, '1528873251', '1528873251'],
                ['/system/user-rank/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/delete-all', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user-rank/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/active', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/create', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/delete', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/delete-all', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/inactive', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/index', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/online-users', '2', null, null, null, '1518083077', '1518083077'],
                ['/system/user/update', '2', null, null, null, '1513838979', '1513838979'],
                ['/system/user/view', '2', null, null, null, '1513838979', '1513838979'],
                ['/tools/*', '2', null, null, null, '1513838979', '1513838979'],
                ['/tools/ico', '2', null, null, null, '1539334899', '1539334899'],
                ['/tools/upload', '2', null, null, null, '1513838979', '1513838979'],
                ['/tools/upload-editor', '2', null, null, null, '1513838979', '1513838979'],
                ['基本权限', '1', '后台人员所需要的基本权限', null, null, '1512542066', '1512542066'],
                ['文章管理权限', '1', '管理后台文章权限', null, null, '1512542259', '1512542259'],
                ['演示角色', '1', '用于演示的角色', null, null, '1521768107', '1521768107'],
                ['管理员', '1', '超级管理员权限', null, null, '1498697175', '1512542127'],
            ]);

        $this->createTable('{{%auth_item_child}}', [
            'parent' => $this->string(64)->notNull(),
            'child' => $this->string(64)->notNull(),
        ], $tableOptions);
        $this->createIndex('auth_item_child_parent', '{{%auth_item_child}}', 'parent', false);
        $this->createIndex('auth_item_child_child', '{{%auth_item_child}}', 'child', false);
        $this->batchinsert('{{%auth_item_child}}',
            ['parent','child'],[
                ['管理员', '/*'],
                ['管理员', '/backup/*'],
                ['管理员', '/backup/export/*'],
                ['演示角色', '/backup/export/index'],
                ['管理员', '/backup/export/index'],
                ['管理员', '/backup/export/init'],
                ['管理员', '/backup/export/optimize'],
                ['管理员', '/backup/export/repair'],
                ['管理员', '/backup/export/start'],
                ['管理员', '/backup/import/*'],
                ['管理员', '/backup/import/del'],
                ['演示角色', '/backup/import/index'],
                ['管理员', '/backup/import/index'],
                ['管理员', '/backup/import/init'],
                ['管理员', '/backup/import/start'],
                ['管理员', '/debug/*'],
                ['管理员', '/debug/default/*'],
                ['管理员', '/debug/default/db-explain'],
                ['管理员', '/debug/default/download-mail'],
                ['管理员', '/debug/default/index'],
                ['管理员', '/debug/default/toolbar'],
                ['管理员', '/debug/default/view'],
                ['管理员', '/debug/user/*'],
                ['管理员', '/debug/user/reset-identity'],
                ['管理员', '/debug/user/set-identity'],
                ['管理员', '/gii/*'],
                ['管理员', '/gii/default/*'],
                ['管理员', '/gii/default/action'],
                ['管理员', '/gii/default/diff'],
                ['管理员', '/gii/default/index'],
                ['管理员', '/gii/default/preview'],
                ['管理员', '/gii/default/view'],
                ['管理员', '/rbac/*'],
                ['管理员', '/rbac/assignment/*'],
                ['管理员', '/rbac/assignment/assign'],
                ['演示角色', '/rbac/assignment/index'],
                ['管理员', '/rbac/assignment/index'],
                ['管理员', '/rbac/assignment/revoke'],
                ['演示角色', '/rbac/assignment/view'],
                ['管理员', '/rbac/assignment/view'],
                ['管理员', '/rbac/default/*'],
                ['管理员', '/rbac/default/index'],
                ['管理员', '/rbac/log/*'],
                ['管理员', '/rbac/log/index'],
                ['管理员', '/rbac/log/view'],
                ['管理员', '/rbac/menu/*'],
                ['管理员', '/rbac/menu/create'],
                ['管理员', '/rbac/menu/delete'],
                ['管理员', '/rbac/menu/delete-all'],
                ['演示角色', '/rbac/menu/index'],
                ['管理员', '/rbac/menu/index'],
                ['管理员', '/rbac/menu/update'],
                ['演示角色', '/rbac/menu/view'],
                ['管理员', '/rbac/menu/view'],
                ['管理员', '/rbac/permission/*'],
                ['管理员', '/rbac/permission/assign'],
                ['管理员', '/rbac/permission/create'],
                ['管理员', '/rbac/permission/delete'],
                ['演示角色', '/rbac/permission/index'],
                ['管理员', '/rbac/permission/index'],
                ['管理员', '/rbac/permission/remove'],
                ['管理员', '/rbac/permission/update'],
                ['演示角色', '/rbac/permission/view'],
                ['管理员', '/rbac/permission/view'],
                ['管理员', '/rbac/role/*'],
                ['管理员', '/rbac/role/assign'],
                ['管理员', '/rbac/role/create'],
                ['管理员', '/rbac/role/delete'],
                ['演示角色', '/rbac/role/index'],
                ['管理员', '/rbac/role/index'],
                ['管理员', '/rbac/role/remove'],
                ['管理员', '/rbac/role/update'],
                ['演示角色', '/rbac/role/view'],
                ['管理员', '/rbac/role/view'],
                ['管理员', '/rbac/route/*'],
                ['管理员', '/rbac/route/assign'],
                ['管理员', '/rbac/route/create'],
                ['演示角色', '/rbac/route/index'],
                ['管理员', '/rbac/route/index'],
                ['管理员', '/rbac/route/refresh'],
                ['管理员', '/rbac/route/remove'],
                ['管理员', '/rbac/rule/*'],
                ['管理员', '/rbac/rule/create'],
                ['管理员', '/rbac/rule/delete'],
                ['演示角色', '/rbac/rule/index'],
                ['管理员', '/rbac/rule/index'],
                ['管理员', '/rbac/rule/update'],
                ['演示角色', '/rbac/rule/view'],
                ['管理员', '/rbac/rule/view'],
                ['管理员', '/rbac/user/*'],
                ['管理员', '/rbac/user/active'],
                ['管理员', '/rbac/user/change-password'],
                ['管理员', '/rbac/user/delete'],
                ['管理员', '/rbac/user/inactive'],
                ['演示角色', '/rbac/user/index'],
                ['管理员', '/rbac/user/index'],
                ['演示角色', '/rbac/user/login'],
                ['管理员', '/rbac/user/login'],
                ['演示角色', '/rbac/user/logout'],
                ['管理员', '/rbac/user/logout'],
                ['管理员', '/rbac/user/request-password-reset'],
                ['管理员', '/rbac/user/reset-password'],
                ['管理员', '/rbac/user/signup'],
                ['管理员', '/rbac/user/update'],
                ['管理员', '/rbac/user/update-self'],
                ['演示角色', '/rbac/user/view'],
                ['管理员', '/rbac/user/view'],
                ['管理员', '/site/*'],
                ['演示角色', '/site/dashboard'],
                ['管理员', '/site/dashboard'],
                ['管理员', '/site/error'],
                ['演示角色', '/site/index'],
                ['管理员', '/site/index'],
                ['管理员', '/site/test'],
                ['管理员', '/system/*'],
                ['管理员', '/system/config/*'],
                ['管理员', '/system/config/create'],
                ['管理员', '/system/config/delete'],
                ['管理员', '/system/config/delete-all'],
                ['管理员', '/system/config/index'],
                ['管理员', '/system/config/update'],
                ['管理员', '/system/config/view'],
                ['管理员', '/system/memorandum/*'],
                ['管理员', '/system/memorandum/create'],
                ['管理员', '/system/memorandum/delete'],
                ['管理员', '/system/memorandum/delete-all'],
                ['管理员', '/system/memorandum/index'],
                ['管理员', '/system/memorandum/update'],
                ['管理员', '/system/memorandum/view'],
                ['管理员', '/system/neteasy/*'],
                ['管理员', '/system/neteasy/create'],
                ['管理员', '/system/neteasy/delete'],
                ['管理员', '/system/neteasy/delete-all'],
                ['管理员', '/system/neteasy/index'],
                ['管理员', '/system/neteasy/update'],
                ['管理员', '/system/neteasy/view'],
                ['管理员', '/system/user-rank/*'],
                ['管理员', '/system/user-rank/create'],
                ['管理员', '/system/user-rank/delete'],
                ['管理员', '/system/user-rank/delete-all'],
                ['演示角色', '/system/user-rank/index'],
                ['管理员', '/system/user-rank/index'],
                ['管理员', '/system/user-rank/update'],
                ['演示角色', '/system/user-rank/view'],
                ['管理员', '/system/user-rank/view'],
                ['管理员', '/system/user/*'],
                ['管理员', '/system/user/active'],
                ['管理员', '/system/user/create'],
                ['管理员', '/system/user/delete'],
                ['管理员', '/system/user/delete-all'],
                ['管理员', '/system/user/inactive'],
                ['管理员', '/system/user/index'],
                ['管理员', '/system/user/online-users'],
                ['管理员', '/system/user/update'],
                ['管理员', '/system/user/view'],
                ['管理员', '/tools/*'],
                ['管理员', '/tools/ico'],
                ['管理员', '/tools/upload'],
                ['管理员', '/tools/upload-editor'],
            ]);

        $this->createTable('{{%auth_rule}}', [
            'name' => $this->string(64)->notNull(),
            'data' => $this->binary(),
            'created_at' => $this->integer(),
            'updated_at' => $this->integer(),
        ], $tableOptions);
        $this->createIndex('auth_rule_name', '{{%auth_rule}}', 'name', false);

        $this->createTable('{{%config}}', [
            'id' => $this->primaryKey(),
            'name' => $this->string(30)->notNull(),
            'title' => $this->string(50)->notNull(),
            'value' => $this->text(),
            'remark' => $this->string(100)->notNull(),
            'sort' => $this->tinyInteger()->notNull()->defaultValue(0),
            'status' => $this->smallInteger()->notNull()->defaultValue(1),
            'created_at' => $this->integer()->notNull()->defaultValue(0),
            'updated_at' => $this->integer()->notNull()->defaultValue(0),
        ], $tableOptions);
        $this->createIndex('config_name', '{{%config}}', 'name', false);

        $this->createTable('{{%user}}', [
            'id' => $this->primaryKey(),
            'username' => $this->string(32)->notNull()->comment('用户账号'),
            'nickname' => $this->string(32)->notNull()->comment('昵称'),
            'head_pic' => $this->string(255)->comment('头像'),
            'auth_key' => $this->string(32)->notNull()->comment('AuthKey'),
            'password_hash' => $this->string(255)->notNull()->comment('密码'),
            'password_reset_token' => $this->string(255)->notNull()->comment('密码重置码'),
            'access_token' => $this->string(100)->notNull()->comment('Access Token'),
            'mobile' => $this->string(11)->notNull()->comment('手机'),
            'email' => $this->string(255)->notNull()->comment('电子邮件'),
            'status' => $this->smallInteger()->notNull()->comment('状态'),
            'r_id' => $this->integer()->notNull()->comment('用户等级'),
            'created_at' => $this->integer()->notNull()->comment('注册时间'),
            'created_address' => $this->string(200)->notNull()->comment('注册地点'),
            'created_ip' => $this->string(15)->notNull()->comment('注册IP'),
            'last_login_date' => $this->string(30)->notNull()->comment('最后登录时间'),
            'last_login_ip' => $this->string(15)->notNull()->comment('最后登录IP'),
            'last_login_address' => $this->string(200)->notNull()->comment('最后登录地点'),
            'integral' => $this->integer()->defaultValue(0)->comment('积分'),
            'balance' => $this->decimal(10,0)->defaultValue(0)->comment('余额'),
            'updated_at' => $this->integer()->notNull()->defaultValue(0)->comment('修改时间'),
        ], $tableOptions);
        $this->createIndex('user_username', '{{%user}}', 'username', false);
        $this->createIndex('user_mobile', '{{%user}}', 'mobile', false);
        $this->createIndex('user_email', '{{%user}}', 'email', false);
        $this->createIndex('user_status', '{{%user}}', 'status', false);
        $this->createIndex('user_r_id', '{{%user}}', 'r_id', false);

        $this->createTable('{{%user_rank}}', [
            'id' => $this->primaryKey(),
            'name' => $this->string(30)->notNull()->comment('等级名称'),
            'score' => $this->integer(8)->notNull()->comment('积分界限'),
            'discount' => $this->decimal(6,2)->notNull()->comment('折扣百分比'),
            'status' => $this->smallInteger()->notNull()->defaultValue(1)->comment('状态'),
        ], $tableOptions);
        $this->createIndex('user_rank_name', '{{%user_rank}}', 'name', false);
        $this->batchinsert('{{%user_rank}}',
            ['id','name','score','discount','status'],[
                ['1', '普通会员', '0', '1.00', '1'],
                ['2', '一级会员', '2000', '0.95', '1'],
                ['3', '二级会员', '5000', '0.90', '1'],
                ['4', 'VIP会员', '10000', '0.85', '1'],
                ['5', '钻石会员', '100000', '0.80', '1'],
                ['6', '超级会员', '10000000', '0.50', '1'],
            ]);
    }

    public function down()
    {
        $this->dropTable('{{%user_rank}}');
        $this->dropTable('{{%user}}');
        $this->dropTable('{{%config}}');
        $this->dropTable('{{%auth_rule}}');
        $this->dropTable('{{%auth_item_child}}');
        $this->dropTable('{{%auth_item}}');
        $this->dropTable('{{%auth_assignment}}');
        $this->dropTable('{{%admin_log}}');
        $this->dropTable('{{%admin}}');
        $this->dropTable('{{%menu}}');
    }
}
